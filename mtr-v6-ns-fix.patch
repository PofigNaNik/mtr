commit cece39e9fad8d53a1e41cae57348f5ab41ec3ba4
Author: mutantmonkey <mutantmonkey@mutantmonkey.in>
Date:   Sun Apr 21 15:56:59 2013 -0400

    Fix segfault with mixed IPv4/IPv6 nameservers
    
    Fixes bug #1154432

diff --git a/dns.c b/dns.c
index 683a4aa..8ea48ba 100644
--- a/dns.c
+++ b/dns.c
@@ -934,6 +934,8 @@ void dorequest(char *s,int type,word id)
   hp->id = id;	/* htons() deliberately left out (redundant) */
 #ifdef ENABLE_IPV6
   for (i = 0;i < NSCOUNT6;i++) {
+    if (!NSSOCKADDR6(i))
+      continue;
     if (NSSOCKADDR6(i)->sin6_family == AF_INET6)
       (void)sendto(resfd6,buf,r,0,(struct sockaddr *) NSSOCKADDR6(i),
 		   sizeof(struct sockaddr_in6));
@@ -1340,6 +1342,8 @@ void dns_ack6(void)
       }
     } else
       for (i = 0;i < NSCOUNT6;i++) {
+        if (!NSSOCKADDR6(i))
+          continue;
 	if ( addrcmp( (void *) &(NSSOCKADDR6(i)->sin6_addr),
 		      (void *) &(from6->sin6_addr), AF_INET6 ) == 0 )
 	  break;
commit 59c16297a4008ee4b59ae49854d09f49f0713055
Author: Michal Sekletar <sekletar.m@gmail.com>
Date:   Thu Jun 6 16:13:52 2013 +0200

    dns: Fix segfault with mixed ipv4/ipv6 nameservers
    
    Follow-up on bug #1154432.

diff --git a/dns.c b/dns.c
index 8ea48ba..371934f 100644
--- a/dns.c
+++ b/dns.c
@@ -1334,6 +1334,9 @@ void dns_ack6(void)
     if ( addrcmp( (void *) &(from6->sin6_addr), (void *) &localhost6,
                   (int) AF_INET6 ) == 0 ) {
       for (i = 0;i < NSCOUNT6;i++) {
+        if (!NSSOCKADDR6(i))
+          continue;
+
 	if ( addrcmp( (void *) &(NSSOCKADDR6(i)->sin6_addr),
 		      (void *) &(from6->sin6_addr), (int) AF_INET6 ) == 0 ||
 	     addrcmp( (void *) &(NSSOCKADDR6(i)->sin6_addr),
